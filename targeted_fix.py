#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Targeted script to fix specific double UTF-8 encoding corruption patterns in guides-laptops
"""

import os
from pathlib import Path

def fix_specific_corruption_patterns(content):
    """Fix specific corruption patterns found in the files"""

    # These are the exact corrupted sequences and their correct Cyrillic equivalents
    replacements = {
        'Ð енение': 'Решение',
        'енение': 'ешение',
        'Ð енен': 'Реш',
        'нлекннопинанин': 'лектропитании',
        'нлекннопинан': 'электропитан',
        'нопинан': 'ропитан',
        'Созданн': 'Создани',
        'Созданн план': 'Создани план',
        'Вннокан пноизводинелнноннн': 'Высокопроизводительно',
        'пноизводинелнноннн': 'производительно',
        'Уннановинн длн бананеи': 'Установите для батарей',
        'длн': 'для',
        'бананеи': 'батарей',
        'Онклннение авноманиненкого пенеклнненин': 'Отключение автоматического переключения',
        'Онклннен': 'Отключен',
        'авноманиненкого': 'автоматического',
        'пенеклнненин': 'переключения',
        'пенеклннен': 'переключен',
        'В нвойннван плана онклннинн': 'В свойствах плана отключить',
        'нвойннван': 'свойствах',
        'онклннинн': 'отключить',
        'Снижанн ннконнн нкнана': 'Снижать яркость экрана',
        'Снижанн': 'Снижать',
        'ннконнн': 'яркость',
        'нкнана': 'экрана',
        'Онклннанн женнкий динк': 'Отключать жесткий диск',
        'женнкий': 'жесткий',
        'динк': 'диск',
        'Уннановинн макнималнннн пноизводинелнноннн': 'Установите максимально производительно',
        'Уннановинн': 'Установите',
        'макнималнннн': 'максимально',
        'Нанннойки видеоканнн': 'Настройки видеокарт',
        'Нанннойки': 'Настройки',
        'видеоканнн': 'видеокарт',
        'Упнавлен панаменнами 3D': 'Управление параметрами 3D',
        'Упнавлен': 'Управление',
        'панаменнами': 'параметрами',
        'Ð ежим нпнавленин нлекннопинанием â "Ðнедпонинанн макнималнннн пноизводинелнноннн"': 'Режим управления электропитанием → "Предпочитать максимальную производительность"',
        'Ð ежим нпнавленин': 'Режим управления',
        'нлекннопинанием': 'электропитанием',
        'â': '→',
        '"Ðнедпонинанн макнималнннн пноизводинелнноннн"': '"Предпочитать максимальную производительность"',
        'Ðнедпонинанн': 'Предпочитать',
        'Макнималннан пноизводинелнноннн пноненнона â "Ðнедпонинанн макнималнннн пноизводинелнноннн"': 'Максимальная производительность процессора → "Предпочитать максимальную производительность"',
        'Макнималннан': 'Максимальная',
        'пноненнона': 'процессора',
        'AMD Radeon Settings': 'AMD Radeon Settings',
        'Синнема â Пенеклннение гнаники': 'Система → Переключение графики',
        'Синнема': 'Система',
        'â Пенеклннение гнаники': '→ Переключение графики',
        'Пенеклннение': 'Переключение',
        'гнаники': 'графики',
        'Вннокопноизводинелннан длн внен пниложений': 'Высокопроизводительная для всех приложений',
        'Вннокопноизводинелннан': 'Высокопроизводительная',
        'внен': 'всех',
        'Онклннинн нненгонбенежен': 'Отключить энергосбережение',
        'нненгонбенежен': 'энергосбережение',
        'Обновлен днайвенов': 'Обновите драйверов',
        'днайвенов': 'драйверов',
        'видеоканнн': 'видеокарт',
        'GeForce Experience или AMD Software': 'GeForce Experience или AMD Software',
        'Обновине до понледнин венний': 'Обновите до последних версий',
        'понледнин': 'последних',
        'венний': 'версий',
        'Вклннине игновне опнимизании': 'Включите игровые оптимизации',
        'игновне': 'игровые',
        'опнимизании': 'оптимизации',
        'Ð енен': 'Реш',
        'BIOS нанннойки': 'BIOS настройки',
        'Нанннойки пноизводинелннонни': 'Настройки производительности',
        'пноизводинелннонни': 'производительности',
        'Войдине в BIOS': 'Войдите в BIOS',
        'Найдине наздел Power Management': 'Найдите раздел Power Management',
        'наздел': 'раздел',
        'Уннановине пноизводинелнноннн на макнимнм': 'Установите производительность на максимум',
        'макнимнм': 'максимум',
        'Онклннине авноманиненкое пенеклннен': 'Отключите автоматическое переключение'
    }

    fixed_content = content
    for corrupted, correct in replacements.items():
        fixed_content = fixed_content.replace(corrupted, correct)

    return fixed_content

def process_file(file_path):
    """Process a single file"""
    try:
        with open(file_path, 'r', encoding='utf-8') as f:
            content = f.read()

        # Check if file has corruption indicators
        has_corruption = any(indicator in content for indicator in [
            'Ð ен', 'нлекн', 'â', 'â', 'â', 'â', 'â', 'â',
            'ен', 'н', 'н', 'н', 'н', 'н', 'н', 'н', 'н', 'н', 'н'
        ])

        if not has_corruption:
            return False

        # Apply specific fixes
        fixed_content = fix_specific_corruption_patterns(content)

        # Save the fixed content
        with open(file_path, 'w', encoding='utf-8') as f:
            f.write(fixed_content)

        print(f"Fixed: {file_path}")
        return True

    except Exception as e:
        print(f"Error processing {file_path}: {e}")
        return False

def main():
    """Main function"""
    guides_laptops_dir = Path("c:/Users/yashi/Desktop/Новая папка/FixTech-main/guides-laptops")

    if not guides_laptops_dir.exists():
        print(f"Directory not found: {guides_laptops_dir}")
        return

    html_files = list(guides_laptops_dir.glob("*.html"))

    print(f"Processing {len(html_files)} files for specific corruption patterns...")

    fixed_count = 0
    for html_file in html_files:
        if process_file(html_file):
            fixed_count += 1

    print(f"\nFixed {fixed_count} files")

if __name__ == "__main__":
    main()
